<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>树形结构的数据与一维数组数据的相互转换</title>
</head>
<body>
    <h1><a href="https://blog.csdn.net/qq_39009348/article/details/87365547">树形结构的数据与一维数组数据的相互转换</a></h1>

    <script src="http://libs.baidu.com/jquery/1.11.3/jquery.min.js"></script>
    <script>
        var data = [
            {"id":2,"name":"第一级1","pid":0},
            {"id":3,"name":"第二级1","pid":2},
            {"id":5,"name":"第三级1","pid":4},
            {"id":100,"name":"第三级2","pid":3},
            {"id":6,"name":"第三级2","pid":3},
            {"id":601,"name":"第三级2","pid":6},
            {"id":602,"name":"第三级2","pid":6},
            {"id":603,"name":"第三级2","pid":6}
        ];
        // 数组转树形结构数据（原理即为通过设置id为key值，再通过pid去找这个key是否一样，一样则为这数据的子级数据）
        function arrayToJson(treeArray){
            var r = [];
            var tmpMap ={};
            for (var i=0, l=treeArray.length; i<l; i++) {
                // 以每条数据的id作为obj的key值，数据作为value值存入到一个临时对象里面
                tmpMap[treeArray[i]["id"]]= treeArray[i]; 
            } 
            console.log('tmpMap',tmpMap)
            for (i=0, l=treeArray.length; i<l; i++) {
                var key=tmpMap[treeArray[i]["pid"]];
                console.log('key',key)
                //循环每一条数据的pid，假如这个临时对象有这个key值，就代表这个key对应的数据有children，需要Push进去
                //如果这一项数据属于哪个数据的子级
                if (key) {
                    // 如果这个数据没有children
                    if (!key["children"]){
                        key["children"] = [];
                        key["children"].push(treeArray[i]);
                    // 如果这个数据有children
                    }else{
                        key["children"].push(treeArray[i]);
                    }       
                }else {
                    //如果没有这个Key值，就代表找不到属于哪个数据，那就代表没有父级,直接放在最外层
                    r.push(treeArray[i]);
                }
            }
            return r
        }
        console.log(arrayToJson(data));
    </script>   
</body>
</html>