<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
    body, html,#allmap {width: 100%;height: 100%;overflow: hidden;margin:0;font-family:"微软雅黑";}
    </style>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=6RSLDg5lTnqLu06IAVnGkmL1RZN7YzeA"></script>
    <!-- 百度地图备用AK ifKcVYj28KCWBfEqLNbHmurkLwtNegh7 6RSLDg5lTnqLu06IAVnGkmL1RZN7YzeA 提供者：郭坤-->
    <title>地图展示</title>
    <style>
        #allmap{
            width: 500px;
            height: 500px;
        } 
        .anchorBL{
            display: none;/* 不显示百度标志 */
        } 
        #testInput-suggest div{
            border-bottom:1px solid red!important;
        }
        #testInput-suggest div:last-child{
            border:0 none!important;
        }
    </style>
</head>
<body>
    <input type="text" class="input" placeholder="116.403119,39.911614"/>
    <button class="btn">定位</button>

    <input id="testInput" type="text" style="width:450px;"/>
    <div id="allmap"></div>
</body>
</html>
<script src="../../cssjs/jquery.min.js"></script>
<script src="jquery.select.js"></script>
<script type="text/javascript"> 
    // 百度地图API功能
    var map = new BMap.Map("allmap",{minZoom:4,maxZoom:18});    // 设置地图最大最小级别
    map.centerAndZoom(new BMap.Point(121.47 , 31.23), 11);  // 初始化地图,设置中心点坐标和地图级别
    //添加地图类型控件
    map.addControl(new BMap.MapTypeControl({
        mapTypes:[
            BMAP_NORMAL_MAP,
            BMAP_HYBRID_MAP
        ]}));     
    map.setCurrentCity("上海");          // 设置地图显示的城市 此项是必须设置的
    map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放


    //创建图标
    var pt1 = new BMap.Point(121.47 , 31.23);
    var myIcon1 = new BMap.Icon("hongqi.png", new BMap.Size(16,16));
    var marker1 = new BMap.Marker(pt1,{icon:myIcon1});  // 创建标注
        marker1.addEventListener("click",function(){alert(1)});
        map.addOverlay(marker1); 

    var pt2 = new BMap.Point(121.57 , 31.23);
    var myIcon2 = new BMap.Icon("hongqi.png", new BMap.Size(16,16));
    var marker2 = new BMap.Marker(pt2,{icon:myIcon2});  // 创建标注
        marker2.addEventListener("click",function(){alert(2)});
        map.addOverlay(marker2); 


    //项目搜索地图定位函数
    function setPlace(longitude,latitude) {//经纬度
       map.centerAndZoom(new BMap.Point(longitude,latitude), 7);
    }

    //开启搜索功能
     var datas =[
        {"text":"中国石油天然气股份有限公司","longitude":116.23,"latitude":39.54}, 
        {"text":"中国一","longitude":118.23,"latitude":39.54}, 
    ];

    $.selectSuggest('testInput',datas);





//**到一定级别禁止拖动开始*****************************************
    // map.addEventListener("zoomend", function(){    
    //     //console.log("地图缩放至：" + this.getZoom() + "级");   
    //     if(this.getZoom() == 4){
    //         map.disableDragging();  //缩放到一定级别禁止拖动
    //     }else{
    //         map.enableDragging();
    //     } 
    // });
//**到一定级别禁止拖动结束*****************************************




//==== 浏览器位置定位开始====================================
    // var geolocation = new BMap.Geolocation();
    // geolocation.getCurrentPosition(function(r){
    //     if(this.getStatus() == BMAP_STATUS_SUCCESS){
    //         var mk = new BMap.Marker(r.point);
    //         map.addOverlay(mk);
    //         map.panTo(r.point);
    //         console.log('您的位置：'+r.point.lng+','+r.point.lat);
    //     }
    //     else {
    //         console.log('failed'+this.getStatus());
    //     }        
    // });
//==== 位置定位结束====================================


//*** IP定位开始 ************************
    // function myFun(result){
    //     console.log(result);
    //     var cityName = result.name;
    //     map.setCenter(cityName);
    //     console.log("当前定位城市:"+cityName);
    // }
    // var myCity = new BMap.LocalCity();
    // myCity.get(myFun); 
//*** IP定位开始 ************************

//--------------------- 城市模糊搜索开始  --------------------
    // function setPlace(value) {
    //     var local, point, marker = null;
    //     local = new BMap.LocalSearch(map, { //智能搜索
    //         onSearchComplete: function(){
    //             console.log(local.getResults());
    //             var pp = local.getResults().getPoi(0).point;
    //             console.log(pp);
    //             map.centerAndZoom(pp, 8);
    //         }
    //     });
    //     local.search(value);
    // }
    // // 按钮事件
    // $(".btn").click(function(){
    //     setPlace($(".input").val());
    // });
    // $(document).keydown(function(event){ 
    //     if(event.keyCode==13){ 
    //         $(".btn").click(); 
    //     } 
    // })
//--------------------- 城市模糊搜索结束  --------------------
</script>