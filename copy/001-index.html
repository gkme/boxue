<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>01-ztree基础示例</title>
    <link rel="shortcut icon" href="../favicon.ico"/>
    <style>
        *{margin: 0;padding: 0;box-sizing:border-box;}
    </style>
</head>

<script src="../cssjs/jquery.min.js"></script>
<link rel="stylesheet" href="../cssjs/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href="../cssjs/ztree/zTreeStyle/zTreeStyle.css">
<script src="../cssjs/bootstrap/js/bootstrap.min.js"></script>
<script src="../cssjs/ztree/js/jquery.ztree.all.min.js"></script>

<script>

var zNodes =[
    { name: "002-tfootsearch.html",url:"copy"},
    { name: "003-控制台代码.html",url:"copy"},
    { name: "004-datatables.html",url:"copy"},
];    
</script>
<body>
    <textarea cols="50" rows="30" id="t" style="position: fixed;left:-500px;"></textarea>
    
    <div style="position: fixed;right:0;bottom:0;width: 100%;height: 100%;">
        <div id="left" style="position: absolute;left:0:top:0;height: 100%;width: 366px;border-right:1px dashed #999">
            <input type="text" id="key" autocomplete="off" value="" class="empty" style="height:34px;line-height: 34px;width:230px;border-radius:8px;border:2px solid green;outline:none;"/>
            <ul id="treeDemo" class="ztree" style="width:366px;height: 565px; overflow:auto;margin-top:10px;"></ul>
        </div>
        <div id="right" style="position: absolute;left:366px;right:0;bottom:0;height: 100%;">
            <iframe id="ifamesrc" src="" frameborder="0" width="100%" height="100%"></iframe>
        </div>
    </div>
    <script>
        var h = $(document).height() - 60;
        $("#treeDemo").css("height",h+"px");
        var adress = "";
        var setting = {
            data: {
                key: {
                    url: "xUrl"//不让节点跳转
                }
            },
            callback: {
                onClick: zTreeOnClick //节点的点击事件
            },
            view: {
                fontCss: getFontCss //加背景颜色
            }
        };
        function focusKey(e) {
            var zTree = $.fn.zTree.getZTreeObj("treeDemo");
            this.value = "";
            zTree.expandAll(false);
            if (key.hasClass("empty")) {
                key.removeClass("empty");
            }
        }
        function blurKey(e) {
            if (key.get(0).value === "") {
                key.addClass("empty");
            }
        }
        var lastValue = "", nodeList = [];
        function searchNode(e) {
            var zTree = $.fn.zTree.getZTreeObj("treeDemo");
            var value = $.trim(key.get(0).value);
            if (key.hasClass("empty")) {
                value = "";
            }
            if (lastValue === value) return false;
            lastValue = value;
            updateNodes(false);
            if (value === "") return false;
            nodeList = zTree.getNodesByParamFuzzy("name", value);
            updateNodes(true);
        }

        function updateNodes(highlight) {
            var zTree = $.fn.zTree.getZTreeObj("treeDemo");

            zTree.expandAll(false);

            for( var i=0, l=nodeList.length; i<l; i++) {
                nodeList[i].highlight = highlight;
                zTree.expandNode(nodeList[i], true ,false ,true, false);
                var parent = nodeList[i].getParentNode();
                if(null != parent && !parent.open){
                    zTree.expandNode(parent, true, false, false, false);
                }
                zTree.updateNode(nodeList[i]);
            }
            zTree.refresh();
        }
        function getFontCss(treeId, treeNode) {
            return (!!treeNode.highlight) ? {color:"#A60000", "font-weight":"bold"} : {color:"#333", "font-weight":"normal"};
        }

        //节点的点击事件
        function zTreeOnClick(event, treeId, treeNode, clickFlag) {
            var treeNodePath = treeNode.name;
            var isboxue = location.href.indexOf("D:/boxue");
            if(isboxue>-1){//本地直接打开copy访问
                treeNodePath = treeNode.name;
                if(treeNode.navigation){//是根节点，需要导航页面
                    treeNodePath = treeNode.navigation.replace("copy/","");
                }
            }
            $("#ifamesrc").attr("src",treeNodePath)
        }

        var key;
        $(document).ready(function(){
            $.fn.zTree.init($("#treeDemo"), setting, zNodes);
            key = $("#key");
            key.bind("focus", focusKey)
            .bind("blur", blurKey)
            .bind("input", searchNode);
        });
    </script>
</body>

</html>